# 体育锻炼记录系统

基于 Electron 的桌面应用，用于记录和管理体育锻炼数据。

## 功能特点

- 记录跑步、力量训练等锻炼数据
- 可视化展示锻炼趋势和成果
- 查看和管理所有锻炼历史
- 数据本地存储，完全离线使用
- 自定义数据存储位置，方便备份和迁移

## 快速开始

### 安装依赖

```bash
npm install
```

### 运行应用

```bash
npm start
```

### 开发模式（带开发者工具）

```bash
npm run dev
```

## 项目结构

```
record_exercise/
├── src/                     # 源代码目录
│   ├── main/               # 主进程
│   │   ├── main.js         # Electron 主进程入口
│   │   └── preload.js      # IPC 通信桥接
│   └── renderer/           # 渲染进程
│       ├── index.html      # 应用界面
│       ├── css/
│       │   └── styles.css  # 样式文件
│       └── js/
│           └── app.js      # 前端逻辑
├── package.json            # 项目配置
└── README.md               # 项目文档
```

## 数据存储位置

### 默认存储位置

- **Windows**: `%APPDATA%\exercise-tracker-electron\exercise-data.json`
- **macOS**: `~/Library/Application Support/exercise-tracker-electron/exercise-data.json`
- **Linux**: `~/.config/exercise-tracker-electron/exercise-data.json`

### 自定义存储位置

从版本 1.0.0 开始，用户可以自定义数据文件的存储位置：

1. 打开应用，点击左侧菜单的"设置"
2. 在"数据存储位置"部分，点击"更改存储位置"按钮
3. 选择您想要保存数据文件的位置
4. 应用会自动将现有数据复制到新位置

**注意事项：**
- 更改存储位置后，原有数据会被自动复制到新位置
- 配置信息存储在默认的应用数据目录中
- 建议选择一个安全且方便备份的位置（如云同步文件夹）

## 打包发布

```bash
# 安装打包工具
npm install --save-dev electron-builder

# 打包应用
npm run dist
```

打包后的文件会在 `dist` 目录中。

## 技术栈

- Electron - 桌面应用框架
- Chart.js - 数据可视化
- JavaScript + CSS3

## 开发日志

### 版本 1.0.2 - 用户体验优化

#### 新增功能
1. **图表自动滚动定位**
   - 点击展示图表复选框时，页面自动平滑滚动到对应图表位置
   - 延迟 150ms 确保图表渲染完成后再滚动
   - 提升用户查看图表的便捷性

#### 界面美化
2. **历史记录表格优化**
   - 表头样式改为纯白色背景 + 深灰色文字，简洁大方
   - 表头支持滚动时固定在顶部（sticky 定位）
   - 优化鼠标悬停效果，移除缩放动画避免页面抖动
   - 使用柔和的渐变背景高亮悬停行
   - 整体更加优雅稳定

### 版本 1.0.1 - 重要 Bug 修复

#### 修复的核心问题

**问题描述：** 提交记录或删除记录后，表单输入框无法点击和输入，只有最小化窗口后重新打开才能恢复正常。

**根本原因：** Electron 中的 `alert()` 和 `confirm()` 是阻塞式模态对话框，会冻结主窗口交互并夺取键盘焦点。关闭对话框后，焦点可能无法正确返回到表单元素，导致输入失效。

**解决方案：**
1. **Toast 提示组件**：实现非阻塞式 Toast 提示，替换所有 `alert()` 调用
   - 位置：右上角滑入
   - 自动 3 秒消失
   - 支持成功、错误、信息三种类型
   - 不影响表单焦点和用户操作

2. **自定义确认对话框**：实现非阻塞式确认对话框，替换所有 `confirm()` 调用
   - 基于 Promise 的异步操作
   - 支持键盘操作（ESC 取消）
   - 不会冻结界面和键盘输入
   - 保持表单焦点状态

3. **图表显示优化**：修复折线图超出容器边框的问题
   - 移除固定高度，使用 Canvas 高度约束
   - 确保图表完全显示在容器内

**技术要点：**
- 所有提示和确认操作均为非阻塞式
- 使用 Promise/async-await 处理用户交互
- 保证表单元素焦点状态始终正确
- 提升用户体验，避免界面卡顿

## 许可证

ISC
